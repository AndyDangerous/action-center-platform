//= require EpicEditor

$(document).on('ready', function() {
  $('.epiceditor').each(function() {
    var textarea = $('textarea', this).first();
    var container = $('<div>').insertAfter(textarea);
    var editor = new EpicEditor({
      container: container[0],
      textarea: textarea[0],
      basePath: '',
      clientSideStorage: false,
      theme: {
        base: "<%= asset_path "EpicEditor/epiceditor/themes/base/epiceditor.css" %>",
        preview: "<%= asset_path "EpicEditor/epiceditor/themes/preview/github.css" %>",
        editor: "<%= asset_path "EpicEditor/epiceditor/themes/editor/epic-light.css" %>"
      },
      autogrow: true,
    }).load(function() {
      this._textareaElement.style.display = 'none';
    });

    $(this).data('editor', editor);
  });
});

function reflowEpicEditor() {
  $('.epiceditor:visible').each(function() {
    $(this).data('editor').reflow();
  });
}
